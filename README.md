# Cable Haunt Test Script
​
This is a script for automatically testing whether you modem is vulnerable for the [Cable Haunt Vulnerability](https://cablehaunt.com).
​
<p align="center">
**ONLY RUN THIS CODE ON HARDWARE YOU OWN**​
</p>

## How to run it
First install [pipenv](https://github.com/pypa/pipenv).

```
pipenv install
```

```
pipenv run python test.py
```

## How to it works
The script automatically scans your network to find the spectrum analyser and tries to establish connection to the websocket. The script will test if the modem rejects requests from an external origin, by setting the header parameters similar to how a browser or other modern client would. If the connection is established the spectrum analyser can be reached indirectly from outside the local network and is, at least partly, vulnerable. The script will afterwards, with your permission, send a specially crafted package that reboots the modem if vulnerable. If this happens the modem is completely vulnerable.
​
## How change IP and ports
If the script does not find the spectrum analyzer it could be that it is not looking at the correct IPs or ports. We have not yet seen a cable modem where "192.168.100.1" is not an alias for the cable modem or where with active ports above 10000 so the script only scans this per default. However it is possible that a specific IPS og manufacturer has changed this and we would very much like to know if it happens. The IPs (and port) are set as variables in the top of the script so if you want to test more that the default, please change line 20 and 21

```
targets = ['192.168.100.1']
portRange = range(23, 10000)
```

to for instance

```
targets = ['192.168.100.1', '192.168.0.1', '192.168.1.1]
portRange = range(23, 65535)
```

Remember that the more you add the longer the port scan will take.

## Disclaimer
This tool should be used for verification purposes only, and should not be used on equipment you do not own or otherwise is not allowed to destroy.
There are absolutely no guarantees that this tool will detect any vulnerabilities, nor that it will not damage your equipment or cause damage in some other way. USE AT YOUR OWN RISK.
​
## Other Resources
​
- [**The Cable Haunt website**](https://cablehaunt.com)
- [**Download the technical report**](https://github.com/Lyrebirds/Cable-Haunt-Report/releases/latest/download/report.pdf)
- [**Sagemcom F@st exploit POC**](https://github.com/Lyrebirds/Fast8690-exploit)
Collapse
